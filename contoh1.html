<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulir Email dan Nama</title>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>

    <h2>Formulir Email dan Nama</h2>

    <form id="dataForm">
        <label for="nama">Nama:</label>
        <input type="text" id="nama" name="nama" required>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>

        <button type="button" onclick="submitData()">Submit</button>
    </form>

    <script>
        // Load Google Sheets API
        gapi.load('client', initClient);

        // API key dari proyek Google Cloud Console Anda
        const apiKey = 'AIzaSyDouwud_w9P8fnsOWtkXmnvO8URkZkwKag';

        // ID Spreadsheet Google Sheets Anda
        const spreadsheetId = '1zCMs2of_OjRARGMm4LktcGJiTBc-5ugBPQneIndfcp4';

        // ID Klien OAuth dari file JSON
        const oauthClientId = '427072042320-fc4am609iq40nioieflo6697tvpdchbt.apps.googleusercontent.com';

        function initClient() {
            gapi.client.init({
                apiKey: apiKey,
                discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
                clientId: oauthClientId,
                scope: "https://www.googleapis.com/auth/spreadsheets",
            }).then(function () {
                console.log('Google Sheets API client initialized');
            }, function (error) {
                console.log('Error initializing Google Sheets API client: ' + error);
            });
        }

        // Fungsi untuk menambahkan baris baru ke Google Sheets
        function addRowToSheet(nama, email) {
            const values = [
                [nama, email]
            ];

            gapi.client.sheets.spreadsheets.values.append({
                spreadsheetId: spreadsheetId,
                range: 'Sheet1',  // Sesuaikan dengan nama sheet Anda
                valueInputOption: 'RAW',
                resource: {
                    values: values
                }
            }).then(function (response) {
                console.log('Data appended: ', response);
            }, function (error) {
                console.error('Error appending data: ', error);
            });
        }

        // Fungsi untuk menangani submit formulir
        function submitData() {
            // Ambil nilai dari formulir
            const nama = document.getElementById('nama').value;
            const email = document.getElementById('email').value;

            // Validasi input
            if (!nama || !email) {
                alert('Mohon isi semua kolom.');
                return;
            }

            // Tambahkan data baru ke Google Sheets
            addRowToSheet(nama, email);

            // Reset formulir
            document.getElementById('dataForm').reset();
        }
    </script>
    <script src="https://apis.google.com/js/api.js?onload=initClient"></script>
</body>
</html>
